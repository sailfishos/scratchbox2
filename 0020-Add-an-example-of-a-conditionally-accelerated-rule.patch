From fd947566b61526c2a0e6536d6c77bfd05e3d9d83 Mon Sep 17 00:00:00 2001
From: Juha Kallioinen <juha.kallioinen@jollamobile.com>
Date: Thu, 9 May 2013 11:58:11 +0000
Subject: [PATCH] Add an example of a conditionally accelerated rule

Signed-off-by: Juha Kallioinen <juha.kallioinen@jollamobile.com>
---
 modes/obs-rpm-build+pp/fs_rules.lua | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/modes/obs-rpm-build+pp/fs_rules.lua b/modes/obs-rpm-build+pp/fs_rules.lua
index 1917b14..73e7e36 100644
--- a/modes/obs-rpm-build+pp/fs_rules.lua
+++ b/modes/obs-rpm-build+pp/fs_rules.lua
@@ -111,6 +111,13 @@ accelerated_program_actions = {
 	{ map_to = target_root, protection = readonly_fs_always },
 }
 
+-- conditionally accelerated programs:
+-- check if file exists in target_root and only then try to accelerate it
+conditionally_accelerated_program_actions = {
+	{ if_exists_in = target_root, then_actions = accelerated_program_actions, protection = readonly_fs_always },
+	{ map_to = target_root, protection = readonly_fs_always },
+}
+
 -- Path == "/":
 rootdir_rules = {
 		-- Special case for /bin/pwd: Some versions don't use getcwd(),
-- 
1.8.3-rc3

